(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],u=0,m=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={index:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var d=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0104":function(t,e,n){},"0773":function(t,e,n){t.exports=n.p+"img/toggle.a04685e8.svg"},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},14:function(t,e){},15:function(t,e){},2:function(t,e){},"220d":function(t,e,n){t.exports=n.p+"img/connect.9fc735ec.svg"},"2cab":function(t,e,n){t.exports=n.p+"img/lnc-logo-light.9a9fa77e.svg"},3:function(t,e){},4:function(t,e){},"40e0":function(t,e,n){t.exports=n.p+"img/inbox.661c10e6.svg"},5:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"root"}},[n("Convert")],1)},i=[],r=(n("99af"),n("0104"),n("db49")),o=n.n(r),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"content-area"},[n("Sidebar"),n("MailContent")],1),n("FooterMobile")],1),n("SentMessageModal")],1)},l=[],d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:[{active:t.activeMobileMenu},"mail-left"]},[t._m(0),a("div",{staticClass:"mail-left__compose"},[a("button",{staticClass:"btn-mail btn-mail__sent btn-compose cursor-pointer",on:{click:t.handleSendMessageModal}},[t._m(1)])]),a("div",{staticClass:"mail-left__menu hidden-sm"},[a("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[a("router-link",{staticClass:"mail-left__menu-item mb-10 d-flex align-center justify-between",class:{active:"/inbox"===t.$route.path||"/"===t.$route.path},attrs:{to:"/inbox"}},[a("span",{staticClass:"d-flex align-center"},[a("img",{staticClass:"flex-shrink-0",attrs:{src:n("40e0")}}),a("span",{staticClass:"ml-20 title"},[t._v("Inbox")])]),a("span",{staticClass:"letter-spacing-5"},[t._v(t._s(t.inboxMsgNum))])])],1),a("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[a("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-between",class:{active:"/sent"===t.$route.path},attrs:{to:"/sent"}},[a("span",{staticClass:"d-flex align-center"},[a("img",{staticClass:"flex-shrink-0",attrs:{src:n("8f55")}}),a("span",{staticClass:"ml-20 title"},[t._v("Sent")])]),a("span",{staticClass:"letter-spacing-5"},[t._v(t._s(t.sentMsgNum))])])],1)]),a("div",{staticClass:"mail-left__static d-flex justify-center flex-column pl-10"},[a("div",{staticClass:"theme-change mb-16"},[a("label",{staticClass:"switch-theme"},[a("input",{staticClass:"input__switch-theme",attrs:{type:"checkbox"},domProps:{checked:t.darkMode},on:{click:t.handleToggleDarkMode}}),a("span",{staticClass:"slider"})])]),a("div",{staticClass:"f-12 f-500 mb-30 mb-sm-0"},[t._m(2),a("div",{staticStyle:{"padding-left":"10px"}},[a("div",[t._v(t._s(t.statics.activeAccount)+" active accounts,")]),a("div",[t._v(t._s(t.statics.totalsAccount)+" total accounts,")]),a("div",[t._v(t._s(t.statics.messages)+" messages.")])])]),t._m(3)]),a("div",{staticClass:"mail-left__connect"},[a("button",{class:[{"is-hidden":t.isLoggedIn},"btn-mail cursor-pointer btn-connect"],on:{click:t.handleAuth}},[t._m(4)]),a("div",{class:[{"is-hidden":!t.isLoggedIn},"mail-left__info"]},[a("div",{staticClass:"is-hidden block-sm f-12"},[t._v("Wallet connected:")]),a("div",{staticClass:"d-flex pl-10 pl-sm-0"},[t._m(5),a("div",{staticClass:"pl-8 pr-20 flex-grow-1"},[a("div",{staticClass:"name title-16 f-700 mb-4"},[t._v(t._s(t.username))]),a("div",{staticClass:"f-500"},[t._v("Balance: "+t._s(t.balance)+" NEAR")])]),a("span",{staticClass:"p-relative cursor-pointer",staticStyle:{top:"3px"},on:{click:t.handleLogOut}},[a("svg",{staticClass:"flex-shrink-0",attrs:{width:"16",height:"15",viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M4.8 6.3999L4.8 7.9999L12 7.9999L12 10.3999L16 7.1999L12 3.9999L12 6.3999L4.8 6.3999Z",fill:"#888A90"}}),a("path",{attrs:{d:"M1.5999 14.3999L8.7999 14.3999C9.6823 14.3999 10.3999 13.6823 10.3999 12.7999L10.3999 9.5999L8.7999 9.5999L8.7999 12.7999L1.5999 12.7999L1.5999 1.5999L8.7999 1.5999L8.7999 4.7999L10.3999 4.7999L10.3999 1.5999C10.3999 0.717502 9.6823 -9.82912e-05 8.7999 -9.83683e-05L1.5999 -9.89978e-05C0.717504 -9.90749e-05 -9.60786e-05 0.717501 -9.61558e-05 1.5999L-9.71349e-05 12.7999C-9.7212e-05 13.6823 0.717503 14.3999 1.5999 14.3999Z",fill:"#888A90"}})])])])])])])},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"logo d-flex align-center justify-between"},[a("div",{staticClass:"d-flex align-center"},[a("img",{staticClass:"flex-shrink-0",attrs:{src:n("5f2b")}}),a("span",{staticClass:"\n          text-logo\n          title-16\n          f-700 f-obi\n          ml-10\n          letter-spacing-5\n          text-justify\n        "},[t._v(" Near Messaging Service ")])]),a("div",{staticClass:"flex-shrink-0 is-hidden block-sm"},[a("img",{staticClass:"logo-dark",attrs:{src:n("fb89")}}),a("img",{staticClass:"logo-light",attrs:{src:n("5b81")}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[a("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("6e81")}}),a("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("619a")}}),a("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20 ml-sm-10"},[t._v(" COMPOSE ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b",[t._v("Statics:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hidden-sm"},[a("img",{staticClass:"logo-dark",attrs:{src:n("fb89")}}),a("img",{staticClass:"logo-light",attrs:{src:n("5b81")}}),a("div",{staticClass:"f-12 f-500 mb-10"},[a("br"),a("a",{attrs:{href:"https://learnnear.club",target:"_blank"}},[a("img",{staticClass:"logo-dark",attrs:{src:n("ff0b")}}),a("img",{staticClass:"logo-light",attrs:{src:n("2cab")}})])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[a("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("220d")}}),a("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("67b5")}}),a("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20"},[t._v(" CONNECT ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex-shrink-0"},[n("span",{staticClass:"status background-active"})])}],m=n("1da1"),g=(n("96cf"),n("b680"),n("a9e3"),n("ac1f"),n("5319"),n("d9eb")),f=n("9dcd"),h=n.n(f),p=o()("development"),v=(60*Math.pow(10,12)).toFixed(),_=(Math.pow(10,24),function(t){return h()(t||"0").times(Math.pow(10,24)).toFixed()});function w(){return M.apply(this,arguments)}function M(){return M=Object(m["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(g["connect"])(Object.assign({deps:{keyStore:new g["keyStores"].BrowserLocalStorageKeyStore}},p));case 2:return e=t.sent,window.walletConnection=new g["WalletConnection"](e),window.accountId=window.walletConnection.getAccountId(),t.next=7,new g["Contract"](window.walletConnection.account(),p.contractName,{viewMethods:["getStaticsInfo","getSentMsgNum","getSentMessages","getInboxMsgNum","getInboxMessages","getMessage","getStatics"],changeMethods:["sendMessage"]});case 7:window.contract=t.sent;case 8:case"end":return t.stop()}}),t)}))),M.apply(this,arguments)}function b(){window.walletConnection.signOut(),window.location.replace(window.location.origin+window.location.pathname)}function x(){window.walletConnection.requestSignIn(p.contractName)}function S(t,e,n){var a={fromIndex:0,toIndex:-1};return t>0&&(a.toIndex=t-1-(e-1)*n,a.fromIndex=a.toIndex-n+1,a.fromIndex<0&&(a.fromIndex=0)),a}function C(t,e){try{var n='{\n          "contract": "alpha.neatar.testnet",\n          "method": "avatar_of",\n          "params": { "account_id": "'.concat(t,'" },\n          "rpc_node": "https://rpc.testnet.near.org"\n      }'),a="https://rest.nearapi.org/view",s=new XMLHttpRequest;s.open("POST",a),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){4===s.readyState&&e(s.responseText)},s.send(n)}catch(i){console.error("Unable to get avatar",i),e(null)}}var E={data:function(){return{statics:{activeAccount:0,totalsAccount:0,messages:0},balance:0}},computed:{isLoggedIn:function(){return this.$store.state.auth.auth.isLogin},activeMobileMenu:function(){return this.$store.state.activeMobileMenu},username:function(){return window.walletConnection.getAccountId()},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},darkMode:function(){return this.$store.state.darkMode}},mounted:function(){this.getSentMessageNum(),this.getInboxMessageNum(),this.getStatics(),this.getBalance()},methods:{handleAuth:function(){x()},handleLogOut:function(){b()},handleToggleDarkMode:function(){this.$store.commit("TOGGLE_DARK_MODE")},handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleResetSelectedMailId:function(){this.$store.commit("RESET_MESSAGE_CONVERSATION",null)},getSentMessageNum:function(){var t=this;window.contract.getSentMsgNum({accountId:this.username}).then((function(e){t.$store.commit("SET_SENT_MSG_NUM",e)}))},getInboxMessageNum:function(){var t=this;window.contract.getInboxMsgNum({accountId:this.username}).then((function(e){t.$store.commit("SET_INBOX_MSG_NUM",e)}))},getStatics:function(){var t=this;window.contract.getStatics().then((function(e){t.statics.activeAccount=e.sentAccountNum,t.statics.totalsAccount=e.accountNum,t.statics.messages=e.messageNum}))},getBalance:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoggedIn){e.next=8;break}return e.next=3,window.walletConnection.account("example-account.testnet");case 3:return n=e.sent,e.next=6,n.getAccountBalance();case 6:a=e.sent,t.balance=Number(g["utils"].format.formatNearAmount((null===a||void 0===a?void 0:a.available)||0)).toFixed(2);case 8:return e.abrupt("return",0);case 9:case"end":return e.stop()}}),e)})))()}}},I=E,k=n("2877"),N=Object(k["a"])(I,d,u,!1,null,"872a978a",null),y=N.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mail-content-container flex-grow-1"},[a("div",{staticClass:"mail-content__col mail-content__component",class:{"d-none":t.windowWidth<=1024&&t.msgInboxId}},[a("header",{staticClass:"mail-content__header"},[a("div",{staticClass:"mail-content__header-col"},[a("div",{staticClass:"mail-content__header-title f-700 mb-4 d-flex align-center"},[a("img",{staticStyle:{"max-width":"29px"},attrs:{src:n("5f2b")}}),t._v(" "+t._s(t.routePathSent?"Sent":"Inbox")+" ")]),a("div",{staticClass:"f-500 mb-30 mb-md-16 mb-sm-0"},[a("span",[t._v(" "+t._s(t.routePathSent?t.sentMsgNum:t.inboxMsgNum)+" ")]),t._v(" Messages, 0 Unread ")])]),a("div",{staticClass:"\n          d-flex\n          align-center\n          justify-between\n          mail-content__header-col mail-content__header-col-right\n        "},[a("div",{staticClass:"d-flex align-center no-wrap text-right top"},[a("div",[t._v("Page "+t._s(t.page))]),a("div",{staticClass:"ml-20 mr-20 ml-sm-6 mr-sm-0"}),a("div",{staticClass:"mail-content__button hidden-sm"},[a("div",[a("span",{staticClass:"mail-content__button-prev cursor-pointer mr-4 mr-sm-16",on:{click:function(e){t.page>1&&t.prevPage()}}}),a("span",{staticClass:"mail-content__button-next cursor-pointer",on:{click:function(e){return t.nextPage()}}})])])])])]),a("div",{class:[{"is-hidden":t.userLogin},"title-16 f-700 mail-content__list-none"]},[t._v(" Connect your NEAR wallet to start using NEAR Messaging Service! ")]),t.userLogin?a("router-view"):t._e()],1),a("AllMessages")],1)},O=[],R=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__col mail-right",class:{"d-block":t.windowWidth<=1024&&t.msgInboxId}},[t._m(0),n("section",{class:[{"is-hidden":!t.userLogin},"mail-right__body"]},[n("div",{class:[{"is-hidden":t.msgInboxId},"mail-right__no-selected"]},[t._v(" No conversations selected. ")]),n("div",{class:[{"is-hidden":!t.msgInboxId},"mail-right__selected scrollbar"]},t._l(t.dataMsgConversation,(function(t){return n("MessageDetail",{key:t.id,attrs:{from:t.from,dataMsg:t}})})),1)])])}),L=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"mail-right__header"},[a("div",{staticClass:"mail-right__header-title f-700 mb-4 d-flex align-center"},[a("img",{staticClass:"is-hidden block-sm mr-sm-10",staticStyle:{"max-width":"29px"},attrs:{src:n("5f2b")}}),t._v(" Message conversation ")]),a("div",{staticClass:"f-500"},[t._v("Message conversation history.")])])}],$=n("2909"),T=(n("e9c4"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"mail-right__item"},[n("header",{staticClass:"mail-right__item-header d-flex"},[n("Avatar",{attrs:{accountId:t.from,size:"60"}}),n("div",{staticClass:"\n        info\n        pl-30 pl-xl-16 pl-md-16 pl-sm-10\n        flex-grow-1\n        d-flex\n        justify-between\n      "},[n("div",[n("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.dataMsg.from))]),n("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.dataMsg.to))])]),n("div",{staticClass:"text-right"},[n("div",{staticClass:"action mb-10 mb-sm-4 d-flex"},[n("div",{staticClass:"\n              action-sent\n              reply\n              cursor-pointer\n              d-flex\n              align-center\n              mr-40 mr-xl-20\n              md-md-20 md-sm-20\n            ",on:{click:t.handleShowReply}},[n("svg",{staticClass:"mr-10",attrs:{width:"28",height:"20",viewBox:"0 0 28 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M28 20C28 20 25.3167 5.55556 11.6667 5.55556V0L0 10L11.6667 19.3333V12.9236C19.075 12.9236 24.1354 13.5417 28 20Z",fill:"#3B4551"}})]),t._v(" Reply ")]),n("div",{staticClass:"action-sent forward cursor-pointer d-flex align-center",on:{click:t.handleShowForward}},[t._v(" Forward "),n("svg",{staticClass:"ml-10",attrs:{width:"28",height:"20",viewBox:"0 0 28 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 20C0 20 2.68333 5.55556 16.3333 5.55556V0L28 10L16.3333 19.3333V12.9236C8.925 12.9236 3.86458 13.5417 0 20Z",fill:"#3B4551"}})])])]),n("div",{staticClass:"f-500 date"},[t._v(t._s(t.dataMsg.timestamp))])])])],1),n("section",{staticClass:"mail-right__item-body"},[n("div",{staticClass:"title cursor-pointer",on:{click:function(e){t.showDetail=!t.showDetail}}},[t._v(" Title: "+t._s(t.dataMsg.title)+" ")]),n("ReplyMessage",{class:{"is-hidden":!t.showReply},attrs:{id:t.dataMsg.id,title:t.dataMsg.title,to:t.dataMsg.from,from:t.dataMsg.to}}),n("ForwardMessage",{class:{"is-hidden":!t.showForward},attrs:{id:t.dataMsg.id,title:t.dataMsg.title,to:t.dataMsg.to,from:t.dataMsg.from}}),n("div",{class:[{"is-hidden":!t.showDetail||t.showReply||t.showForward},"description f-500"]},[n("div",{staticClass:"content"},[n("div",[t._v(t._s(t.dataMsg.content))])])])],1)])}),j=[],G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mail-right__sent"},[a("header",{staticClass:"mail-right__item-header d-flex"},[a("Avatar",{attrs:{accountId:t.from,size:"60"}}),a("div",{staticClass:"info pl-30 flex-grow-1 d-flex justify-between"},[a("div",[a("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.from))]),a("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.to))])]),a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn-sent cursor-pointer d-flex align-center",on:{click:t.handleReply}},[a("img",{attrs:{src:n("8f55")}}),a("span",[t._v("Sent")])])])])],1),a("section",[a("div",{staticClass:"content"},[a("div",{staticClass:"title title-20 f-700 mb-10"},[t._v("Re: "+t._s(t.title))]),a("div",{staticClass:"description f-500 mb-10"},[a("div",{staticClass:"textArea-ForwardAndReply"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"data"}],attrs:{placeholder:"Enter the content here"},domProps:{value:t.data},on:{input:function(e){e.target.composing||(t.data=e.target.value)}}})])])]),a("div",[a("div",{staticClass:"f-500"},[t._v("Select NEAR to send:")]),a("div",{staticClass:"near__value-list d-flex"},[a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])])])])])},P=[],D=n("b654"),U=n.n(D),F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"logo avatar"},[n("img",{attrs:{src:t.url,width:t.size,height:t.size}})])},z=[],B={props:["accountId","size"],data:function(){return{url:"../../public/assets/images/icon.svg"}},mounted:function(){this.getAvatarUrl(this.accountId)},methods:{getAvatarUrl:function(t){var e=this,n=localStorage.getItem("user-avatar-".concat(t));n?this.url=n:C(t,(function(n){n&&(e.url=n,localStorage.setItem("user-avatar-".concat(t),n))}))}}},H=B,J=Object(k["a"])(H,F,z,!1,null,null,null),W=J.exports,V={components:{Avatar:W},props:["id","title","to","from"],data:function(){return{data:"",amount:.1}},methods:{handleReply:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={title:t.title,content:t.data,attachmentFiles:{}},e.prev=1,console.log("start send",n,_(t.amount)),e.next=5,U.a.packMessage(n);case 5:if(a=e.sent,0===a.code){e.next=8;break}throw new Error("Error when packing messsage"+a);case 8:t.amount?window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:t.id,expiredTime:"0"},v,_(t.amount)).then(console.log):window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"}).then(console.log),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()}}},K=V,Z=Object(k["a"])(K,G,P,!1,null,"43adf97d",null),X=Z.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mail-right__sent"},[a("header",{staticClass:"mail-right__item-header d-flex"},[a("Avatar",{attrs:{accountId:t.from,size:"60"}}),a("div",{staticClass:"info pl-30 flex-grow-1 d-flex justify-between"},[a("div",[a("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.from))]),a("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.to))])]),a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn-sent cursor-pointer d-flex align-center",on:{click:t.handleForward}},[a("img",{attrs:{src:n("8f55")}}),a("span",[t._v("Sent")])])])])],1),a("section",[a("div",{staticClass:"content"},[a("div",{staticClass:"title title-20 f-700 mb-10"},[t._v("Fw: "+t._s(t.title))]),a("div",{staticClass:"description f-500 mb-10"},[a("div",{staticClass:"textArea-ForwardAndReply"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"data"}],attrs:{placeholder:"Enter the content here"},domProps:{value:t.data},on:{input:function(e){e.target.composing||(t.data=e.target.value)}}})])])]),a("div",[a("div",{staticClass:"f-500"},[t._v("Select NEAR to send:")]),a("div",{staticClass:"near__value-list d-flex"},[a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])])])])])},Y=[],Q={components:{Avatar:W},props:["id","title","to","from"],data:function(){return{data:"",amount:.1}},methods:{handleForward:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={title:t.title,content:t.data,attachmentFiles:{}},e.prev=1,console.log("start send",n,_(t.amount)),e.next=5,U.a.packMessage(n);case 5:if(a=e.sent,0===a.code){e.next=8;break}throw new Error("Error when packing messsage"+a);case 8:t.amount?window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:t.id,expiredTime:"0"},v,_(t.amount)).then(console.log):window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"}).then(console.log),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()}}},tt=Q,et=Object(k["a"])(tt,q,Y,!1,null,"cbb2270a",null),nt=et.exports,at={props:["dataMsg","from"],components:{ReplyMessage:X,ForwardMessage:nt,Avatar:W},data:function(){return{showDetail:this.dataMsg.id===this.$store.state.messageConversation.msgInboxId,showReply:!1,showForward:!1}},methods:{handleShowReply:function(){this.showForward||(this.showReply=!this.showReply)},handleShowForward:function(){this.showReply||(this.showForward=!this.showForward)}}},st=at,it=Object(k["a"])(st,T,j,!1,null,"ee8d1442",null),rt=it.exports,ot={components:{MessageDetail:rt},data:function(){return{windowWidth:window.innerWidth,dataMsgConversation:[]}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},computed:{userLogin:function(){return this.$store.state.auth.auth.isLogin},msgInboxId:function(){return this.$store.state.messageConversation.msgInboxId}},watch:{msgInboxId:function(){this.dataMsgConversation=[],this.getMessages(this.msgInboxId)}},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},getMessages:function(t){var e=this;if(null!==t){var n=window.localStorage.getItem("msg-".concat(t));n?this.updateDataMessage(JSON.parse(n)):window.contract.getMessage({msgId:t}).then((function(n){window.localStorage.setItem("msg-".concat(t),JSON.stringify(n)),e.updateDataMessage(n)}))}},updateDataMessage:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){var a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,U.a.depackMessage(t);case 2:a=n.sent,0===a.prevMsgId?e.dataMsgConversation.push(a):(e.getMessages(a.prevMsgId),s=Object($["a"])(e.dataMsgConversation),s.push(a),e.dataMsgConversation=s);case 4:case"end":return n.stop()}}),n)})))()}}},ct=ot,lt=Object(k["a"])(ct,R,L,!1,null,"5b99311c",null),dt=lt.exports,ut={components:{AllMessages:dt},data:function(){return{windowWidth:window.innerWidth}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},computed:{userLogin:function(){return this.$store.state.auth.auth.isLogin},msgInboxId:function(){return this.$store.state.messageConversation.msgInboxId},routeInboxSent:function(){return"/inbox"===this.$route.path||"/"===this.$route.path},routePathSent:function(){return"/sent"===this.$route.path},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},countPage:function(){return 0},page:function(){return this.$store.state.page}},watch:{$route:function(t,e){t.name!==e.name&&this.$store.commit("SET_PAGE",1)}},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},nextPage:function(){this.$store.commit("SET_PAGE",this.page+1)},prevPage:function(){this.$store.commit("SET_PAGE",this.page-1)}}},mt=ut,gt=Object(k["a"])(mt,A,O,!1,null,"f6adbf18",null),ft=gt.exports,ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"footer-mobile flex-sm is-hidden"},[a("button",{staticClass:"btn-toggle-menu",on:{click:t.handleActiveMobileMenu}},[a("img",{attrs:{src:n("0773")}})]),a("div",{staticClass:"mail-left__menu d-flex align-center pl-20"},[a("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[a("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-between",class:{active:t.routePathInbox},attrs:{to:"/inbox"}},[a("span",{staticClass:"d-flex align-center"},[a("img",{staticClass:"flex-shrink-0",attrs:{src:n("40e0")}}),a("span",{staticClass:"ml-10 title"},[t._v("Inbox")])]),a("span",{staticClass:"letter-spacing-5 pl-10"},[t._v(t._s(t.inboxMsgNum))])])],1),a("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[a("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-center ml-4",class:{active:t.routePathSent},attrs:{to:"/sent"}},[a("span",{staticClass:"d-flex align-center"},[a("img",{staticClass:"flex-shrink-0",attrs:{src:n("8f55")}}),a("span",{staticClass:"ml-10 title"},[t._v("Sent")])]),a("span",{staticClass:"letter-spacing-5 pl-10"},[t._v(t._s(t.sentMsgNum))])])],1)]),a("div",{staticClass:"mail-content__button"},[a("div",[a("span",{staticClass:"mail-content__button-prev cursor-pointer mr-4 mr-sm-16",on:{click:function(e){t.page>1&&t.prevPage()}}}),a("span",{staticClass:"mail-content__button-next cursor-pointer",on:{click:function(e){return t.nextPage()}}})])]),a("button",{staticClass:"btn-mail btn-mail__sent btn-compose__footer cursor-pointer",on:{click:t.handleSendMessageModal}},[t._m(0)])])},pt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[a("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("6e81")}}),a("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("619a")}}),a("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20 ml-sm-10"},[t._v(" COMPOSE")])])}],vt={data:function(){return{isRoute:!1}},mounted:function(){},computed:{username:function(){return window.walletConnection.getAccountId()},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},routePathSent:function(){return"/sent"===this.$route.path},routePathInbox:function(){return"/inbox"===this.$route.path||"/"===this.$route.path},page:function(){return this.$store.state.page}},methods:{handleActiveMobileMenu:function(){this.$store.commit("TOGGLE_ACTIVE_MOBILE_MENU"),this.$store.state.sendMessageModal.isShow&&this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleResetSelectedMailId:function(){this.$store.commit("RESET_MESSAGE_CONVERSATION",null)},nextPage:function(){this.$store.commit("SET_PAGE",this.page+1)},prevPage:function(){this.$store.commit("SET_PAGE",this.page-1)}}},_t=vt,wt=Object(k["a"])(_t,ht,pt,!1,null,"e67be612",null),Mt=wt.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["modal-sent",{"is-hidden":!t.showModal},{"modal-expand":t.expandModal},{"modal-minimize":t.minimizeModal}]},[a("header",{staticClass:"\n      modal-sent__header\n      d-flex\n      align-center\n      justify-between\n      mb-30 mb-sm-0\n    "},[t._m(0),a("div",{staticClass:"action hidden-sm"},[a("span",{staticClass:"btn-minimize cursor-pointer",on:{click:t.handleMinimizeSendMessageModal}},[a("svg",{attrs:{width:"20",height:"4",viewBox:"0 0 20 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("line",{attrs:{x1:"1.5",y1:"1.64258",x2:"18.5",y2:"1.64258",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])]),a("span",{staticClass:"btn-expand cursor-pointer ml-20 mr-20",on:{click:t.handleExpandSendMessageModal}},[a("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M0 14.1426L5.57678 12.6483L1.49429 8.5658L0 14.1426ZM14.1421 0.000442743L8.56536 1.49473L12.6478 5.57722L14.1421 0.000442743ZM3.53553 11.3142L11.3137 3.53598L10.6066 2.82887L2.82843 10.607L3.53553 11.3142Z",fill:"#888A90"}})])]),a("span",{staticClass:"btn-close cursor-pointer",on:{click:t.handleCloseSendMessageModal}},[a("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M2.14209 16.1426L16.2842 2.00044",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}}),a("path",{attrs:{d:"M2.14209 2L16.2842 16.1421",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])])])]),a("div",{staticClass:"f-8 is-hidden block-sm mb-20"},[t._v(" Message conversation history. ")]),a("section",{staticClass:"modal-sent__body"},[a("div",{staticClass:"form-input d-flex pb-10 mb-20"},[a("span",[t._v("To: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.to,expression:"to"}],attrs:{placeholder:"Enter the email here"},domProps:{value:t.to},on:{input:function(e){e.target.composing||(t.to=e.target.value)}}})]),a("div",{staticClass:"form-input d-flex pb-10 mb-20"},[a("span",[t._v("Subject: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{placeholder:"Enter the subject here"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),a("div",{staticClass:"form-textarea mb-20"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"data"}],attrs:{placeholder:"Enter the content here"},domProps:{value:t.data},on:{input:function(e){e.target.composing||(t.data=e.target.value)}}})]),a("div",{staticClass:"f-500 mb-16"},[t._v("Select NEAR to send:")]),a("div",{staticClass:"d-flex align-center justify-between"},[a("div",{staticClass:"near__value-list d-flex"},[a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),a("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])]),a("div",{staticClass:"btnModalContainer"},[a("button",{staticClass:"btn-sent cursor-pointer d-flex align-center flex-shrink-0",on:{click:t.handleSendMessageModal}},[a("img",{attrs:{src:n("8f55")}}),a("span",[t._v("Sent")])]),a("button",{staticClass:"\n            btn-sent btn-cancel\n            cursor-pointer\n            d-flex\n            align-center\n            flex-shrink-0\n          ",on:{click:t.handleCloseSendMessageModal}},[t._v(" Cancel ")])])])])])},xt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title title-20 f-700 d-flex align-center"},[a("img",{staticClass:"is-hidden block-sm mr-10",staticStyle:{width:"29px"},attrs:{src:n("5f2b")}}),t._v(" New message ")])}],St={data:function(){return{to:"",title:"",data:"",amount:.1}},computed:{showModal:function(){return this.$store.state.sendMessageModal.isShow},expandModal:function(){return this.$store.state.sendMessageModal.isExpand},minimizeModal:function(){return this.$store.state.sendMessageModal.isMinimize}},methods:{handleSendMessageModal:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={title:t.title,content:t.data,attachmentFiles:{}},e.prev=1,console.log("start send",n,_(t.amount)),e.next=5,U.a.packMessage(n);case 5:if(a=e.sent,0===a.code){e.next=8;break}throw new Error("Error when packing messsage"+a);case 8:t.amount?window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"},v,_(t.amount)).then(console.log):window.contract.sendMessage({to:t.to,title:a.title,data:a.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"}).then(console.log),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()},handleCloseSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleExpandSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL_EXPAND")},handleMinimizeSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL_MINIMIZE")}}},Ct=St,Et=Object(k["a"])(Ct,bt,xt,!1,null,"0f48a494",null),It=Et.exports,kt={components:{Sidebar:y,MailContent:ft,FooterMobile:Mt,SentMessageModal:It}},Nt=kt,yt=Object(k["a"])(Nt,c,l,!1,null,"469853e3",null),At=yt.exports,Ot=o()("production");console.log("networkId:".concat(Ot.networkId," CONTRACT_NAME:").concat(Ot.contractName)),window.networkId=Ot.networkId;var Rt={created:function(){document.title="NEAR Messaging Service"},name:"App",components:{Convert:At},computed:{isSignedIn:function(){return window.walletConnection.isSignedIn()},darkMode:function(){return this.$store.state.darkMode}},watch:{darkMode:{immediate:!0,handler:function(){this.$store.state.darkMode?document.querySelector("html").setAttribute("data-theme","light"):document.querySelector("html").setAttribute("data-theme","dark")}},isSignedIn:{immediate:!0,handler:function(){this.$store.commit("SET_AUTH",this.isSignedIn)}}}},Lt=Rt,$t=Object(k["a"])(Lt,s,i,!1,null,null,null),Tt=$t.exports,jt=n("8c4f"),Gt=n("2f62"),Pt={auth:{isLogin:!!window.walletConnection&&window.walletConnection.isSignedIn()}},Dt={},Ut={},Ft={SET_AUTH:function(t,e){t.auth.isLogin=e}},zt={state:Pt,getters:Dt,actions:Ut,mutations:Ft};a["a"].use(Gt["a"]);var Bt={modules:{auth:zt},state:{darkMode:JSON.parse(localStorage.getItem("darkMode")),activeMobileMenu:!1,sendMessageModal:{isShow:!1,isExpand:!1,isMinimize:!1},messageConversation:{msgInboxId:null},inboxMsgNum:0,sentMsgNum:0,page:1,inboxSearchKeyword:"",sentSearchKeyword:""},mutations:{TOGGLE_DARK_MODE:function(t){t.darkMode=!t.darkMode,localStorage.setItem("darkMode",JSON.stringify(t.darkMode))},TOGGLE_ACTIVE_MOBILE_MENU:function(t){t.activeMobileMenu=!t.activeMobileMenu},TOGGLE_SEND_MESSAGE_MODAL:function(t){t.sendMessageModal.isShow=!t.sendMessageModal.isShow},TOGGLE_SEND_MESSAGE_MODAL_EXPAND:function(t){t.sendMessageModal.isExpand=!t.sendMessageModal.isExpand},TOGGLE_SEND_MESSAGE_MODAL_MINIMIZE:function(t){t.sendMessageModal.isMinimize=!t.sendMessageModal.isMinimize},MESSAGE_CONVERSATION:function(t,e){t.messageConversation.msgInboxId=e},RESET_MESSAGE_CONVERSATION:function(t,e){t.messageConversation.msgInboxId=e},SET_INBOX_MSG_NUM:function(t,e){t.inboxMsgNum=e},SET_SENT_MSG_NUM:function(t,e){t.sentMsgNum=e},SET_PAGE:function(t,e){t.page=e},SET_INBOX_SEARCH:function(t,e){t.inboxSearchKeyword=e},SET_SENT_SEARCH:function(t,e){t.sentSearchKeyword=e}}},Ht=new Gt["a"].Store(Bt),Jt=Ht,Wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__list scrollbar"},[0===t.inboxMsgNum?n("div",[t._v(" You have no message."),n("br"),t._v(" Do you want to send a message to someone? Please click "),n("span",{staticClass:"link f-700",on:{click:t.handleSendMessageModal}},[t._v("here")]),t._v(" to start!!! ")]):t._l(t.dataMsgInbox,(function(e){return n("article",{key:e.id,staticClass:"mail-content__item d-flex",class:t.checkUnread(e.id)?"":"unread",on:{click:function(n){return t.handleSelectedMail(e.id)}}},[n("Avatar",{attrs:{accountId:e.from,size:"40"}}),n("div",{staticClass:"content pl-20 pl-md-10 flex-grow-1"},[n("header",{staticClass:"d-flex justify-between mb-10 mb-sm-0 mail-content__item-header"},[n("div",{staticClass:"flex-grow-1 mail-content__item-header__top pr-20"},[n("div",{staticClass:"name title-16 f-700"},[t._v(t._s(e.from))]),n("div",{staticClass:"title f-500"},[t._v("Title: "+t._s(e.title))])]),n("div",{staticClass:"text-right f-500"},[n("div",{staticClass:"status-read"},[t.checkUnread(e.id)?t._e():n("span",[t._v("Unread")])]),n("div",{staticClass:"date-time no-wrap"},[t._v(t._s(e.timestamp))])])])])],1)})),n("div",{staticClass:"is-hidden"},[t._v(t._s(t.reRender))])],2)},Vt=[],Kt=(n("a630"),n("3ca3"),n("d3b7"),n("6062"),n("ddb0"),n("caad"),n("2532"),n("d81d"),{components:{Avatar:W},data:function(){return{dataMsgInbox:[],readMailId:[],accountId:null,reRender:null}},mounted:function(){this.getAccountId(),this.getInboxMsg()},computed:{inboxMsgNum:function(){return this.$store.state.inboxMsgNum},page:function(){return this.$store.state.page}},watch:{page:function(){this.getInboxMsg()},inboxMsgNum:function(){this.getInboxMsg()}},methods:{handleSelectedMail:function(t){this.$store.commit("MESSAGE_CONVERSATION",t);var e=JSON.parse(localStorage.getItem(this.accountId+" inbox"));if(this.reRender=t,e){var n=Object($["a"])(e);n.push(t);var a=Array.from(new Set(n));this.readMailId=a}var s=Object($["a"])(this.readMailId);s.push(t);var i=Array.from(new Set(s));this.readMailId=i,e&&e.includes(t)||localStorage.setItem(this.accountId+" inbox",JSON.stringify(this.readMailId))},checkUnread:function(t){var e=JSON.parse(localStorage.getItem(this.accountId+" inbox"));return!!e&&e.includes(t)},handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},getAccountId:function(){this.accountId=window.walletConnection.getAccountId()},getInboxMsg:function(){var t=this;if(0!==this.inboxMsgNum){var e=S(this.inboxMsgNum,this.page,20);window.contract.getInboxMessages({accountId:this.accountId,fromIndex:e.fromIndex,toIndex:e.toIndex}).then((function(e){var n=e.map((function(t){return{baseSite:t.baseSite,expiredTime:t.expiredTime,from:t.from,to:t.to,timestamp:t.timestamp,id:t.id,prevMsgId:t.prevMsgId,title:t.title,data:t.data}})),a=n.map((function(e){return t.updateDataMessage(e)}));return Promise.all(a)})).then((function(e){t.dataMsgInbox=e}))}},updateDataMessage:function(t){return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U.a.depackMessage(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}}}),Zt=Kt,Xt=Object(k["a"])(Zt,Wt,Vt,!1,null,"17d7d440",null),qt=Xt.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__list scrollbar"},[0===t.sentMsgNum?n("div",[t._v(" You haven't sent any message."),n("br"),t._v(" Do you want to send a message to someone? Please click "),n("span",{staticClass:"link f-700",on:{click:t.handleSendMessageModal}},[t._v("here")]),t._v(" to start!!! ")]):t._l(t.dataMsgSent,(function(e){return n("article",{key:e.id,staticClass:"mail-content__item d-flex",class:t.checkUnread(e.id)?"":"unread",on:{click:function(n){return t.handleSelectedMail(e.id)}}},[n("Avatar",{attrs:{accountId:e.from,size:"40"}}),n("div",{staticClass:"content pl-20 pl-md-10 flex-grow-1"},[n("header",{staticClass:"d-flex justify-between mb-10 mb-sm-0 mail-content__item-header"},[n("div",{staticClass:"flex-grow-1 mail-content__item-header__top pr-20"},[n("div",{staticClass:"name title-16 f-700"},[t._v(t._s(e.from))]),n("div",{staticClass:"title f-500"},[t._v("Title: "+t._s(e.title))])]),n("div",{staticClass:"text-right f-500"},[n("div",{staticClass:"status-read"},[t.checkUnread(e.id)?t._e():n("span",[t._v("Unread")])]),n("div",{staticClass:"date-time no-wrap"},[t._v(t._s(e.timestamp))])])])])],1)})),n("div",{staticClass:"is-hidden"},[t._v(t._s(t.reRender))])],2)},Qt=[],te={components:{Avatar:W},data:function(){return{dataMsgSent:[],readMailId:[],accountId:null,reRender:null}},mounted:function(){this.getAccountId(),this.getSentMsg()},computed:{sentMsgNum:function(){return this.$store.state.sentMsgNum},page:function(){return this.$store.state.page}},watch:{page:function(){this.getSentMsg()},sentMsgNum:function(){this.getSentMsg()}},methods:{handleSelectedMail:function(t){this.$store.commit("MESSAGE_CONVERSATION",t),this.reRender=t;var e=JSON.parse(localStorage.getItem(this.accountId+" sent"));if(e){var n=Object($["a"])(e);n.push(t);var a=Array.from(new Set(n));this.readMailId=a}var s=Object($["a"])(this.readMailId);s.push(t);var i=Array.from(new Set(s));this.readMailId=i,e&&e.includes(t)||localStorage.setItem(this.accountId+" sent",JSON.stringify(this.readMailId))},checkUnread:function(t){var e=JSON.parse(localStorage.getItem(this.accountId+" sent"));return!!e&&e.includes(t)},handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},getAccountId:function(){this.accountId=window.walletConnection.getAccountId()},getSentMsg:function(){var t=this;if(0!==this.sentMsgNum){var e=S(this.sentMsgNum,this.page,20);window.contract.getSentMessages({accountId:this.accountId,fromIndex:e.fromIndex,toIndex:e.toIndex}).then((function(e){var n=e.map((function(t){return{baseSite:t.baseSite,expiredTime:t.expiredTime,from:t.from,to:t.to,timestamp:t.timestamp,id:t.id,prevMsgId:t.prevMsgId,title:t.title,data:t.data}})),a=n.map((function(e){return t.updateDataMessage(e)}));return Promise.all(a)})).then((function(e){t.dataMsgSent=e}))}},updateDataMessage:function(t){return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U.a.depackMessage(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}}},ee=te,ne=Object(k["a"])(ee,Yt,Qt,!1,null,"fd094730",null),ae=ne.exports;a["a"].config.productionTip=!1,a["a"].use(jt["a"]);var se=[{path:"/",component:qt,name:"inbox"},{path:"/inbox",component:qt,name:"inbox"},{path:"/sent",component:ae,name:"sent"}],ie=new jt["a"]({mode:"history",routes:se});window.nearInitPromise=w().then((function(){new a["a"]({render:function(t){return t(Tt)},store:Jt,router:ie}).$mount("#app")}))},"5b81":function(t,e,n){t.exports=n.p+"img/lnc-light.c165c156.svg"},"5f2b":function(t,e,n){t.exports=n.p+"img/logo.5acb612a.svg"},6:function(t,e){},"619a":function(t,e,n){t.exports=n.p+"img/compose-light.efecc01c.svg"},"67b5":function(t,e,n){t.exports=n.p+"img/connect-light.eea42ef9.svg"},"6e81":function(t,e,n){t.exports=n.p+"img/compose.48e4e072.svg"},7:function(t,e){},8:function(t,e){},"8f55":function(t,e,n){t.exports=n.p+"img/sent.e5b883c7.svg"},9:function(t,e){},b654:function(t,e,n){(function(t){var a=n("c973").default;n("680c").default;n("96cf"),n("d3b7"),n("25f0"),n("e9c4"),n("99af"),n("2ca0");var s=n("fb08"),i=n("1333"),r=n("bc3a").default;r.defaults.adapter=n("b50d");n("d485");var o={aesKey:"fc2f83976ad1342659c989ff91bc09d4efb891fd877e77fa03f61006467cff0e",isSupportIpfs:!1},c=null;function l(){return d.apply(this,arguments)}function d(){return d=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!=c){t.next=4;break}return t.next=3,s.create({host:"ipfs.infura.io",port:5001,protocol:"https",timeout:"1m"});case 3:c=t.sent;case 4:return t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function u(t){return m.apply(this,arguments)}function m(){return m=a(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}function g(t){return f.apply(this,arguments)}function f(){return f=a(regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new Promise((function(e,a){try{var s=null,i="https://gateway.ipfs.io/ipfs/".concat(n),r=new XMLHttpRequest;r.open("GET",i,!0),r.overrideMimeType("application/octet-stream"),r.responseType="arraybuffer",r.timeout=6e4,r.onload=function(n){e(t.from(r.response))},r.onerror=function(t){console.error("ERROR to get data ".concat(n),t),e(null)},r.send(s)}catch(o){console.error("Unable to get avatar",o)}})),e.next=3,a;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e){var n=t.from(e,"utf8");return n=i.encrypt(o.aesKey,n),n.toString("hex")}function p(e){if(!e)return"";var n=t.from(e,"hex");return n=i.decrypt(o.aesKey,n),n.toString("utf8")}function v(e){var n=t.from(JSON.stringify(e),"utf8");return n=i.encrypt(o.aesKey,n),n}function _(t){var e=i.decrypt(o.aesKey,t),n=e.toString("utf8");return JSON.parse(n)}function w(t,e){return M.apply(this,arguments)}function M(){return M=a(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!isSupportZip){t.next=4;break}return t.next=3,decompressData(e);case 3:e=t.sent;case 4:return n&&(e=i.decrypt(n,e)),t.abrupt("return",JSON.parse(e.toString("utf8")));case 6:case"end":return t.stop()}}),t)}))),M.apply(this,arguments)}function b(t,e){return x.apply(this,arguments)}function x(){return x=a(regeneratorRuntime.mark((function t(e,n){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={success:!1,message:null,data:null},t.prev=1,t.next=4,u(e);case 4:if(s=t.sent,!s){t.next=12;break}return t.next=8,w(s,n);case 8:i=t.sent,i?(a.success=!0,a.message="SUCCESS",a.data=i):a.message="Unable to decode message",t.next=13;break;case 12:a.message="Unable to get data on IPFS for cid: "+e;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](1),console.error("Store message on IPFS error",t.t0),a.message=t.t0.toString();case 19:return t.abrupt("return",a);case 20:case"end":return t.stop()}}),t,null,[[1,15]])}))),x.apply(this,arguments)}function S(t){return C.apply(this,arguments)}function C(){return C=a(regeneratorRuntime.mark((function t(e){var n,a,s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={code:1,message:"Unknow error"},t.prev=1,n.title=h(e.title),a={content:e.content,attachmentFiles:e.attachmentFiles},t.next=6,v(a);case 6:if(s=t.sent,!o.isSupportIpfs){t.next=17;break}return t.next=10,l();case 10:return i=t.sent,t.next=13,i.add(s);case 13:r=t.sent,r&&r.cid?(n.data="#IPFS:"+r.cid.toString(),n.code=0,n.message="SUCCESS"):n.message="Unable to store data on IPFS",t.next=20;break;case 17:n.data="#DIRECT:"+s.toString("hex"),n.code=0,n.message="SUCCESS";case 20:t.next=26;break;case 22:t.prev=22,t.t0=t["catch"](1),console.error("Error to pack message",t.t0),n.message=t.t0.toString();case 26:return t.abrupt("return",n);case 27:case"end":return t.stop()}}),t,null,[[1,22]])}))),C.apply(this,arguments)}function E(t){return I.apply(this,arguments)}function I(){return I=a(regeneratorRuntime.mark((function e(n){var a,s,i,r,o,c,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=l.length>1&&void 0!==l[1]&&l[1],s={baseSite:n.baseSite,expiredTime:n.expiredTime,from:n.from,to:n.to,timestamp:new Date(n.timestamp/Math.pow(10,6)).toLocaleString(),id:n.id,prevMsgId:n.prevMsgId,code:1,message:"Unknown error"};try{s.title=p(n.title),i=n.data,i?i.startsWith("#EXPIRED")?n.content="The message has been expired!":i.startsWith("#DIRECT")?(r=i.substring(8),o=t.from(r,"hex"),c=_(o),s.content=c.content,s.attachmentFiles=c.attachmentFiles,s.code=0,s.message="SUCCESS"):i.startsWith("#IPFS")?(a&&i.substring(6),s.code=0,s.message="SUCCESS"):s.message="Message is invalid format!!!":(s.content="",s.code=0,s.message="SUCCESS")}catch(d){console.error("Error to depack message",d),s.message=d.toString()}return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}e.getMesageData=b,e.packMessage=S,e.depackMessage=E}).call(this,n("1c35").Buffer)},db49:function(t,e,n){var a="nearsms3.near-demo.testnet";function s(t){switch(t){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:a,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:a,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:a,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",VUE_APP_CONTRACT_NAME:"nearsms3.near-demo.testnet",BASE_URL:"/"}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:a};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:a,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:a,masterAccount:"test.near"};default:throw Error("Unconfigured environment '".concat(t,"'. Can be configured in src/config.js."))}}t.exports=s},fb89:function(t,e,n){t.exports=n.p+"img/lnc.ae13a5ad.svg"},ff0b:function(t,e,n){t.exports=n.p+"img/lnc-logo-dark.48c74e1e.svg"}});
//# sourceMappingURL=index.d3e78ae2.js.map